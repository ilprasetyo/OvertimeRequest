@{
    Layout = "Layout";
    var token = ViewData["token"];

}

@*<p>@ViewData["token"]</p>*@
<div class="limiter">
    <div class="container-login100">
        <div class="wrap">
            <form class="login100-form validate-form" id="ResetForm">
                <span class="login100-form-title">
                    Forget Password
                </span>

                <div class="wrap-input100 validate-input" data-validate="New password is reuired">
                    <input class="input100" type="password" name="password" placeholder="New Password" id="password">
                    <span class="focus-input100"></span>
                    <span class="symbol-input100">
                        <i class="fa fa-lock" aria-hidden="true"></i>
                    </span>
                </div>

                <div class="wrap-input100 validate-input" data-validate="Confirm password is required">
                    <input class="input100" type="password" name="confirmpassword" placeholder="Confirm Password" id="confirmpassword">
                    <span class="focus-input100"></span>
                    <span class="symbol-input100">
                        <i class="fa fa-lock" aria-hidden="true"></i>
                    </span>
                </div>

                <div class="input-group mb-3">
                    <input type="hidden" class="form-control" id="token" name="token" value="@token">
                </div>

                <div class="container-login100-form-btn">
                    <button class="login100-form-btn" type="submit">
                        Submit
                    </button>
                </div>

                <div class="text-center text-light p-t-13">
                    <i class="fa fa-long-arrow-left m-l-5" aria-hidden="true"></i>
                    <a class="txt2 text-light" asp-area="" asp-controller="Authentication" asp-action="Index">
                        Back to Login
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

@section customScripts{
    <script>
        $(document).ready(function () {
            $('#ResetForm').submit(function (e) {
                e.preventDefault();
                reset();
            })
        })
        const reset = () => {
            let data_reset = {
                password: $("#password").val(),
                confirm_password: $("#confirmpassword").val(),
                token: $("#token").val(),
            };
            if (data_reset.password === data_reset.confirm_password) {
                $.ajax({
                    type: "PUT",
                    url: "ResetPasswordAPI",
                    data: data_reset,
                    beforeSend: () => {
                        Swal.fire({
                            title: 'Please wait...',
                            showConfirmButton: false,
                            imageUrl: 'https://media.giphy.com/media/jAYUbVXgESSti/giphy.gif',
                            backdrop: `rgba(0,0,0,0.6)`
                        })
                    },
                    success: (data) => {
                        console.log(data)
                        //alert(data)
                        Swal.fire({
                            text: 'Password has been reset',
                            icon: 'success',
                            confirmButtonText: 'Go to Login Page'
                        });
                    },
                    error: (data) => {
                        console.log(data)
                        //alert(data)
                    }
                });
            }
        }
    </script>

}